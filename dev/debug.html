<html>

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        textarea {
            width: 100%;
            height: 30px;
        }
    </style>
</head>

<body>
    <div id="root"></div>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script crossorigin="anonymous" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.15/lodash.js"></script>
    <script src="../dist/convertor.js"></script>

    <script>
        var el = React.createElement;

        ReactDOM.render(el(Page), document.getElementById('root'));

        function Page() {
            var urlParams = new URLSearchParams(window.location.search);

            var s = React.useState(urlParams.get("text"));
            var text = s[0];
            var setText = s[1];
            var source = urlParams.get("source") || "Unicode";
            var items = getSamples(text, source);
            var downloadText = "exports.samples=" + JSON.stringify(items, null, 4);

            return el("div", null,
                el("textarea", {
                    className: "form-conrol",
                    value: text,
                    onChange: function (e) {
                        setText(e.target.value)
                    },
                    style: { fontFamily: getFontFamily(source) }
                }),
                el("a", {
                    href: "data:text/plain;charset=utf-8," + encodeURIComponent(downloadText),
                    download: "samples.js"
                }, "Download"),
                
                el("a", {
                    style: {paddingLeft: "10px"},
                    href: "./visual.html",
                }, "Visual"),
                el(FontTable, { samples: items })
            );
        }

        function FontTable(props) {
            var samples = props.samples;
            return el("table", { className: "table" },
                el("thead", null,
                    el("tr", null,
                        el("th", { scope: "col" }, "Unicode"),
                        el("th", { scope: "col" }, "Anmol"),
                        el("th", { scope: "col" }, "Dr Chartik"),
                        el("th", { scope: "col" }, "Satluj"),
                        el("th", { scope: "col" }, "Joy"),
                        el("th", { scope: "col" }, "Asees"),
                        el("th", { scope: "col" }, "Gurbani Lipi"))),
                el("tbody", null, samples.map(function (s) {

                    return el("tr", { key: s.Unicode },
                        cell(s.Unicode, "Unicode"),
                        cell(s.AnmolLipi, "AnmolLipi"),
                        cell(s.DrChatrikWeb, "DrChatrikWeb"),
                        cell(s.Satluj, "Satluj"),
                        cell(s.Joy, "Joy"),
                        cell(s.Asees, "Asees"),
                        cell(s.GurbaniLipi, "GurbaniLipi"));
                })));
        }

        function getFontFamily(font){
            switch(font){
                case "GurbaniLipi":
                    return "Gurbani-Lipi";
            }
            return font === "DrChatrikWeb" ? "Chatrik" : font;
        }

        function cell(text, font) {
            return el("th", null,
                el("a", {
                    href: "./debug.html?source=" + font + "&text=" + text,
                    style: { fontFamily: getFontFamily(font) }
                }, text),
                el("br"),
                el("div", null, getCodes(text)));
        }

        function getSamples(text, source) {
            var items = text.split(/\s+/);

            return items.map(function (i) {
                return {
                    Unicode: PunjabiFontConvertor.convert(i, "Unicode", source),
                    AnmolLipi: PunjabiFontConvertor.convert(i, "AnmolLipi", source),
                    DrChatrikWeb: PunjabiFontConvertor.convert(i, "DrChatrikWeb", source),
                    Satluj: PunjabiFontConvertor.convert(i, "Satluj", source),
                    Joy: PunjabiFontConvertor.convert(i, "Joy", source),
                    Asees: PunjabiFontConvertor.convert(i, "Asees", source),
                    GurbaniLipi: PunjabiFontConvertor.convert(i, "GurbaniLipi", source),
                }
            })
        }

        function getCodes(str) {
            var codes = [];
            for (var i = 0; i < str.length; i++) {
                codes.push(str.charCodeAt(i).toString(16));
            }
            return codes.join(" ");
        }
    </script>
</body>

</html>